var r,vel,k,w,cols,rows,grid,actives,inOrder,colShiftOptions,colShift,stamp;function setup(){createCanvas(windowWidth,windowHeight).id("cnv"),colorMode(HSB),stamp=floor(random(100,1e4)),productionStamp.innerHTML=stamp,windowWidth<=800?(r=parseFloat(random(5,8).toFixed(2)),vel=3):windowWidth>800&&windowWidth<1500?(r=parseFloat(random(8,11).toFixed(2)),vel=11):(r=parseFloat(random(11,15).toFixed(2)),vel=15),rSize.innerHTML=r,k=20,w=r/sqrt(2),cols=floor(width/w),rows=floor(height/w),grid=[],actives=[],inOrder=[],colShift=(colShiftOptions=[-15,0,150,160,180,200,240,260,280,300])[floor(random(0,colShiftOptions.length))];for(var o=0;o<cols*rows;o++)grid[o]=void 0;var i=(random(width/2)+random(width/2)),t=(random(height/2)+random(height/2)),e=(o=floor(i/w),floor(t/w)),d=createVector(i,t);grid[o+e*cols]=d,actives.push(d)}function draw(){for(var o=0;o<vel;o++)if(actives.length>0){for(var i=floor(random(actives.length)),t=actives[i],e=!1,d=0;d<k;d++){var n=p5.Vector.random2D(),a=random(r,2*r);n.setMag(a),n.add(t);var s=floor(n.x/w),l=floor(n.y/w);if(s>-1&&l>-1&&s<cols&&l<rows&&!grid[s+l*cols]){for(var c=!0,h=-1;h<=1;h++)for(var f=-1;f<=1;f++){var v=grid[s+h+(l+f)*cols];if(v)p5.Vector.dist(n,v)<r&&(c=!1)}if(c){e=!0,grid[s+l*cols]=n,actives.push(n),inOrder.push(n);break}}}e||actives.splice(i,1)}for(h=0;h<inOrder.length;h++)inOrder[h]&&(windowWidth<=800?strokeWeight(min(28,7e3/h**1.05)):windowWidth>800&&windowWidth<1500?strokeWeight(min(28,7e3/h**.95)):strokeWeight(min(51,7e3/h**.93)),stroke(h%50+colShift,200,80),point(inOrder[h].x,inOrder[h].y))}
